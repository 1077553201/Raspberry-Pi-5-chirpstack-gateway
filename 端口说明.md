
# ChirpStack V4 端口功能速查表

> 🚀 本文档详细说明了 ChirpStack V4 (Docker 版) 部署时使用的所有端口及其功能

---

## 📋 端口总览

| 端口号 | 协议 | 服务名称 | 功能说明 | 使用者 |
|:------:|:----:|:--------:|:---------|:-------|
| **1700** | UDP | Gateway Bridge | 网关数据入口 | SX1302 硬件网关 |
| **1883** | TCP | Mosquitto | MQTT 消息总线 | 内部服务、外部MQTT客户端 |
| **8080** | TCP | ChirpStack | Web 管理后台 | 浏览器 (用户) |
| **8090** | TCP | REST API | API 接口服务 | 后端程序 (Java/Python) |
| **5432** | TCP | PostgreSQL | 持久化数据库 | ChirpStack 主程序 |
| **6379** | TCP | Redis | 高速缓存数据库 | ChirpStack 主程序 |
| **3001** | TCP | Gateway Bridge | BasicStation 接口 | (当前未使用) |

---

## 📖 端口详细说明

### 🔌 1700 - Gateway Bridge (UDP)

**服务名称**: Gateway Bridge  
**协议**: UDP  
**功能**: 网关数据入口

**详细说明**:  
接收树莓派硬件 (lora_pkt_fwd) 发来的加密无线电数据包。你的 `global_conf.json` 必须指向此端口。

**谁在使用**:  
SX1302 硬件网关

**重要提示**: ⚠️ 确保 `global_conf.json` 中的 `serv_port_up` 和 `serv_port_down` 均设置为 1700

---

### 📨 1883 - Mosquitto (TCP)

**服务名称**: Mosquitto  
**协议**: TCP  
**功能**: MQTT 消息总线

**详细说明**:  
系统内部传输数据的核心通道。网关接收到的数据会被转换成 MQTT 消息发布到这里；ChirpStack 也是从这里订阅数据。

**谁在使用**:  
- 内部服务 (ChirpStack、Gateway Bridge)
- 外部 MQTT 客户端

**使用场景**:  
系统内部组件通信、外部监控工具连接

---

### 🌐 8080 - ChirpStack Web 管理后台 (TCP)

**服务名称**: ChirpStack  
**协议**: TCP  
**功能**: Web 管理后台

**详细说明**:  
用于人工登录网页进行设备管理、数据查看、应用配置。同时也负责处理 gRPC-web 请求。

**谁在使用**:  
浏览器 (用户)

**访问方式**: `http://<树莓派IP>:8080`  
**默认账号**: admin / admin

---

### 🔧 8090 - REST API (TCP)

**服务名称**: REST API  
**协议**: TCP  
**功能**: API 接口服务

**详细说明**:  
提供 Swagger UI 文档。你的 Java/Spring Boot 后端如果需要通过代码自动管理设备（增删改查），需调用此接口。

**谁在使用**:  
后端程序 (Java/Python 等)

**API 文档**: `http://<树莓派IP>:8090`  
**用途**: 设备自动化管理、批量操作、系统集成

---

### 💾 5432 - PostgreSQL (TCP)

**服务名称**: PostgreSQL  
**协议**: TCP  
**功能**: 持久化数据库

**详细说明**:  
存储用户账号、设备列表、网关配置、应用设置等所有配置信息。

**谁在使用**:  
ChirpStack 主程序

**存储内容**:
- 用户账号信息
- 设备列表
- 网关配置
- 应用设置
- 其他持久化配置

---

### ⚡ 6379 - Redis (TCP)

**服务名称**: Redis  
**协议**: TCP  
**功能**: 高速缓存数据库

**详细说明**:  
存储设备入网的 Session Key（会话密钥）、消息去重记录、下行数据队列。

**谁在使用**:  
ChirpStack 主程序

**缓存内容**:
- 设备 Session Key（会话密钥）
- 消息去重记录
- 下行数据队列
- 临时会话数据

---

### 🔄 3001 - Gateway Bridge BasicStation (TCP)

**服务名称**: Gateway Bridge  
**协议**: TCP  
**功能**: BasicStation 接口

**详细说明**:  
这是另一种较新的网关协议接口。你的 SX1302 目前使用的是 UDP 协议（1700），所以这个端口目前闲置，但在 Docker 中是开放的。

**谁在使用**:  
(当前未使用)

**说明**: 如果你的网关使用 BasicStation 协议而非 Semtech UDP 协议，则需要使用此端口

---

## 📝 使用建议

### 防火墙配置

如果需要外部访问，请确保以下端口在防火墙中开放：

- **1700/UDP** - 网关数据传输（必需）
- **8080/TCP** - Web 管理界面（按需）
- **8090/TCP** - REST API（按需）
- **1883/TCP** - MQTT（外部客户端需要时）

### 安全提示

⚠️ **生产环境注意事项**：

1. 修改 ChirpStack 默认管理员密码
2. 考虑使用反向代理（如 Nginx）并启用 HTTPS
3. 限制 PostgreSQL 和 Redis 端口仅允许本地访问
4. 使用防火墙规则限制外部访问权限
5. 定期备份 PostgreSQL 数据库

### 端口冲突检查

使用以下命令检查端口占用情况：

```bash
# 检查所有相关端口
sudo netstat -tulpn | grep -E '(1700|1883|8080|8090|5432|6379|3001)'

# 或使用 ss 命令
sudo ss -tulpn | grep -E '(1700|1883|8080|8090|5432|6379|3001)'
```

---

## 🔗 相关文档

- [ChirpStack 官方文档](https://www.chirpstack.io/docs/)
- [完整部署指南](./树莓派5docker部署chirpstack-LoRA网关.md)
- [README](./README.md)

---

**最后更新**: 2025-12-11  
**版本**: ChirpStack V4 (Docker)
